Add and refactor unit tests with the purpose of understanding better the functionality
